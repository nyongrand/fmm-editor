<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:FMM.ViewModels"
             xmlns:conv="using:FMM.Converters"
             xmlns:views="using:FMM.Views"
             x:Class="FMM.Views.ClubListView"
             x:DataType="vm:ClubListViewModel"
             mc:Ignorable="d"
             d:DesignWidth="1280"
             d:DesignHeight="720">

	<Design.DataContext>
		<vm:ClubListViewModel />
	</Design.DataContext>

	<UserControl.Resources>
		<conv:GenderToSymbolConverter x:Key="GenderToSymbolConverter" />
	</UserControl.Resources>

	<UserControl.Styles>
		<Style Selector="Border.toolbar">
			<Setter Property="Background" Value="#FF2B2B2B" />
			<Setter Property="BorderBrush" Value="#33000000" />
			<Setter Property="BorderThickness" Value="0,0,0,1" />
		</Style>
		<Style Selector="TextBox.search">
			<Setter Property="Width" Value="260" />
			<Setter Property="Padding" Value="10,0" />
			<Setter Property="Watermark" Value="Search Club / Nation / Competition" />
		</Style>
		<Style Selector="Button.menu">
			<Setter Property="Width" Value="32" />
			<Setter Property="Height" Value="32" />
			<Setter Property="Padding" Value="0" />
		</Style>
		<Style Selector="DataGrid">
			<Setter Property="GridLinesVisibility" Value="All" />
			<Setter Property="HeadersVisibility" Value="All" />
			<Setter Property="RowHeight" Value="32" />
		</Style>
	</UserControl.Styles>

	<Grid RowDefinitions="56,*,32">
		<Border Classes="toolbar" Grid.Row="0">
			<Grid ColumnDefinitions="Auto,*,Auto" VerticalAlignment="Center" Margin="12,0">
				<Border Padding="12,0" CornerRadius="4" VerticalAlignment="Center">
					<Grid ColumnDefinitions="*,Auto" VerticalAlignment="Center">
						<TextBox Classes="search"
								 IsEnabled="{Binding IsDatabaseLoaded}"
								 Text="{Binding SearchQuery, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
						<Button Grid.Column="1"
								Margin="8,0,0,0"
								Command="{Binding ClearSearchCommand}"
								IsEnabled="{Binding IsDatabaseLoaded}"
								IsVisible="{Binding HasSearchQuery}"
								Content="X" />
					</Grid>
				</Border>

				<TextBlock Grid.Column="0"
						   Grid.ColumnSpan="3"
						   HorizontalAlignment="Center"
						   VerticalAlignment="Center"
						   FontSize="18"
						   FontWeight="Bold"
						   Foreground="White"
						   Text="FMM 26 DB Editor - Clubs" />

				<StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
					<Button Classes="menu">
						<Button.Content>
							<TextBlock Text="..." FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center" />
						</Button.Content>
						<Button.Flyout>
							<MenuFlyout Placement="BottomEdgeAlignedRight">
								<MenuItem Header="Support me" Click="Donate_Click" />
								<Separator />
								<MenuItem Header="Load Database" Click="Load_Click" />
								<MenuItem Header="Save" Command="{Binding SaveCommand}" IsEnabled="{Binding IsDatabaseLoaded}" />
								<MenuItem Header="Save As..." Click="SaveAs_Click" IsEnabled="{Binding IsDatabaseLoaded}" />
								<Separator />
								<MenuItem Header="Exit" Click="Exit_Click" />
							</MenuFlyout>
						</Button.Flyout>
					</Button>
				</StackPanel>
			</Grid>
		</Border>

		<Grid Grid.Row="1">
			<DataGrid ItemsSource="{Binding FilteredClubs}"
					  AutoGenerateColumns="False"
					  IsReadOnly="False"
					  SelectionMode="Single"
					  IsVisible="{Binding IsDatabaseLoaded}"
					  SelectedItem="{Binding SelectedClub, Mode=TwoWay}">

				<DataGrid.ContextFlyout>
					<MenuFlyout>
						<MenuItem Header="Copy UID" Click="CopyUid_Click" />
						<MenuItem Header="Copy UID (Hex)" Click="CopyUidHex_Click" />
						<Separator />
						<MenuItem Header="Add Club" Command="{Binding AddCommand}" IsEnabled="{Binding IsEditingEnabled}" />
						<MenuItem Header="Copy Club"
								  Command="{Binding CopyCommand}"
								  CommandParameter="{Binding SelectedClub}"
								  IsEnabled="{Binding IsEditingEnabled}" />
						<MenuItem Header="Edit Club"
								  Command="{Binding EditCommand}"
								  CommandParameter="{Binding SelectedClub}"
								  IsEnabled="{Binding IsEditingEnabled}" />
					</MenuFlyout>
				</DataGrid.ContextFlyout>

				<DataGrid.Columns>
					<DataGridTextColumn Header="UID" Width="80" Binding="{Binding Uid}" IsReadOnly="True" />
					<DataGridCheckBoxColumn Header="AL" Width="60" Binding="{Binding IsAlwaysLoad}" IsReadOnly="False" />
					<DataGridTextColumn Header="Full Name" Width="240" Binding="{Binding FullName}" IsReadOnly="True" />
					<DataGridTextColumn Header="Short Name" Width="150" Binding="{Binding ShortName}" IsReadOnly="True" />
					<DataGridTextColumn Header="6 Lttr" Width="80" Binding="{Binding SixLetterName}" IsReadOnly="True" />
					<DataGridTextColumn Header="3 Lttr" Width="60" Binding="{Binding ThreeLetterName}" IsReadOnly="True" />
					<DataGridTextColumn Header="Nation" Width="150" Binding="{Binding NationName}" IsReadOnly="True" />
					<DataGridTextColumn Header="Status" Width="100" Binding="{Binding StatusText}" IsReadOnly="True" />
					<DataGridTextColumn Header="Competition" Width="200" Binding="{Binding CompetitionName}" IsReadOnly="True" />
					<DataGridTextColumn Header="Pos" Width="60" Binding="{Binding LeaguePos}" IsReadOnly="True" />
					<DataGridTextColumn Header="Rep" Width="70" Binding="{Binding Reputation}" IsReadOnly="True" />
					<DataGridTextColumn Header="Aca" Width="60" Binding="{Binding Academy}" IsReadOnly="True" />
					<DataGridTextColumn Header="Fac" Width="60" Binding="{Binding Facilities}" IsReadOnly="True" />
					<DataGridTextColumn Header="Att Avg" Width="70" Binding="{Binding AttAvg}" IsReadOnly="True" />
					<DataGridTextColumn Header="Att Min" Width="70" Binding="{Binding AttMin}" IsReadOnly="True" />
					<DataGridTextColumn Header="Att Max" Width="70" Binding="{Binding AttMax}" IsReadOnly="True" />
					<DataGridTextColumn Header="Players" Width="70" Binding="{Binding PlayerCount}" IsReadOnly="True" />
					<DataGridTextColumn Header="Type" Width="60" Binding="{Binding TypeText}" IsReadOnly="True" />
					<DataGridTextColumn Header="G" Width="50"
										Binding="{Binding Gender, Converter={StaticResource GenderToSymbolConverter}}"
										IsReadOnly="True" />
				</DataGrid.Columns>
			</DataGrid>

			<Border IsVisible="{Binding IsDatabaseEmpty}" Background="#11000000">
				<StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" MaxWidth="600" Spacing="12">
					<TextBlock FontSize="24" FontWeight="Bold" Text="No Database Loaded" TextAlignment="Center" />
					<TextBlock FontSize="16"
							   Text="Get started by loading an FM26 database"
							   TextAlignment="Center"
							   TextWrapping="Wrap" />
					<Button Width="180" Height="36" Content="Load Database" Click="Load_Click" />
				</StackPanel>
			</Border>
		</Grid>

		<Grid Grid.RowSpan="3"
			  IsVisible="{Binding ShowEditDialog}"
			  Background="#99000000"
			  Panel.ZIndex="10">
			<Border Width="1100"
					HorizontalAlignment="Center"
					VerticalAlignment="Center">
				<views:ClubEditView DataContext="{Binding EditViewModel}" />
			</Border>
		</Grid>

		<Border Grid.Row="2" Padding="12,6">
			<StackPanel Orientation="Horizontal" Spacing="16">
				<TextBlock>
					<Run Text="Folder: " />
					<Run Text="{Binding FolderPath}" />
				</TextBlock>
				<TextBlock>
					<Run Text="Total Clubs: " />
					<Run Text="{Binding ClubsList.Count}" />
				</TextBlock>
				<TextBlock>
					<Run Text="Status: " />
					<Run Text="{Binding StatusMessage}" />
				</TextBlock>
			</StackPanel>
		</Border>
	</Grid>
</UserControl>
